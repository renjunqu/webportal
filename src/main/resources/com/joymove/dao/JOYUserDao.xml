<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.joymove.dao.JOYUserDao">
	<resultMap type="JOYUser" id="joyuser">
		<constructor>
			<idArg column="mobileNo" javaType="string" />
			<arg column="username" javaType="string" />
			<arg column="userpwd" javaType="string" />
			<arg column="email" javaType="String" />
			<arg column="registerTime" javaType="java.util.Date" />
			<arg column="gender" javaType="String" />
			<arg column="addr" javaType="string" />
			<arg column="age"  javaType="String"/>
			<arg column="failedTimes"  javaType="Integer"/>
			<arg column="lockedTime"  javaType="java.util.Date"/>
			<arg column="pushKey"  javaType="String"/>
			<arg column="authToken"  javaType="String"/>
			<arg column="lastActiveTime"  javaType="java.util.Date"/>
			<arg column="authenticateId" javaType="Integer" />
			<arg column="authenticateDriver" javaType="Integer" />
			<arg column="deposit" javaType="Decimal" />
			<arg column="homeAddr" javaType="String" />
			<arg column="homeLatitude" javaType="Decimal" />
			<arg column="homeLongitude" javaType="Decimal" />
			<arg column="corpAddr" javaType="String" />
			<arg column="corpLatitude" javaType="Decimal" />
			<arg column="corpLongitude" javaType="Decimal" />
			<arg column="face_info" javaType="String" />
			<arg column="voice_info" javaType="String" />
		</constructor>
	</resultMap>

	<sql id="userColumn">u.mobileNo, 
	                     u.username, 
	                     u.userpwd, 
	                     u.email,
	                     u.registerTime,
	                     u.gender,
	                     u.addr,
	                     u.age,
	                     u.failedTimes,
	                     u.lockedTime,
	                     u.pushKey,
	                     u.authToken,
	                     u.lastActiveTime,
	                     u.authenticateId,
	                     u.authenticateDriver,
	                     u.deposit,
	                     u.homeAddr,
						 u.homeLatitude,
						 u.homeLongitude,
						 u.corpAddr,
						 u.corpLatitude, 
						 u.corpLongitude,
						 u.face_info,
						 u.voice_info
	</sql>
	<sql id="likeCondition"> like </sql>

	<insert id="insertJOYUser" parameterType="JOYUser" useGeneratedKeys="false">
			insert into JOY_Users(mobileNo,userpwd) values(#{mobileNo},#{userpwd});
	</insert>
	
	
	<select id="getJOYUserByPhone" resultMap="joyuser" parameterType="map">
		select <include refid="userColumn"/>
		from JOY_Users u 
		<where>u.mobileNo=#{mobileNo}</where>
	</select>
	
	<update id="updateJOYUser" parameterType="JOYUser">
		update JOY_Users set 
		<trim suffixOverrides=",">
	                    <if test="userpwd!=null">userpwd=#{userpwd}, </if>
                        <if test="mobileNo!=null">mobileNo=#{mobileNo}, </if>
                        <if test="email!=null">email=#{email},</if>
                        <if test="failedTimes!=null">failedTimes=#{failedTimes},</if>
                        <if test="lockedTime!=null">lockedTime=#{lockedTime},</if>
                        <if test="pushKey!=null">pushKey=#{pushKey},</if>
                        <if test="authToken!=null">authToken=#{authToken},</if>
                        <if test="lastActiveTime!=null">lastActiveTime=#{lastActiveTime},</if>
                        <if test="username!=null">username=#{username},</if>
	                   	<if test="gender!=null">gender=#{gender},</if>
	                   	<if test="authenticateDriver!=null">authenticateDriver=#{authenticateDriver},</if>	
	                   	<if test="homeAddr">homeAddr=#{homeAddr},</if>
	                   	<if test="homeLatitude">homeLatitude=#{homeLatitude},</if>
	                   	<if test="homeLongitude">homeLongitude=#{homeLongitude},</if>
	                   	<if test="corpAddr">corpAddr=#{corpAddr},</if>
	                   	<if test="corpLatitude">corpLatitude=#{corpLatitude},</if>
	                   	<if test="corpLongitude">corpLongitude=#{corpLongitude},</if>
	                   	<if test="deposit">deposit=#{deposit},</if>
						<if test="face_info">face_info=#{face_info},</if>
						<if test="voice_info">voice_info=#{voice_info},</if>
         </trim>
   		 <trim suffixOverrides="or">
         			    <where>
	                            <if test="mobileNo!=null">
	                                mobileNo=#{mobileNo}        
	                            </if>
	     				</where>
	     </trim>

	</update>
	
	
	
	
	
	
		<select id="getAllJOYUser" resultMap="joyuser" parameterType="map">
		select <include refid="userColumn"/> 
		from JOY_Users u 
		<trim suffixOverrides="and">
			<where>
                   <if test="mobileNo!=null">mobileNo=#{mobileNo} and </if>
                   <if test="email!=null">email=#{email} and</if>
                   <if test="userpwd!=null">userpwd=#{userpwd} and </if>
                   <if test="authToken!=null">authToken=#{authToken} and </if>
			</where>
		</trim>
		<if test="page!=null and pageCount!=null">
			limit #{page}, #{pageCount}
		</if>
	</select>
	
</mapper>



















